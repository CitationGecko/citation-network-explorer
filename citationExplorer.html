<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Local Citation Network Explorer</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    

    <!--DataTables-->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.js"></script>

    <!--D3-->
    <script src="https://d3js.org/d3.v4.js"></script>

    <!--My Styles-->
    <link rel="stylesheet" href="styles.css">

    <script src="ionrangeSlider/js/ionrangeSlider/ionrangeSlider.js"></script>
    <link rel="stylesheet" href="ionrangeSlider/css/ionrangeSlider.css"/>
    <link rel="stylesheet" href="ionrangeSlider/css/ion.rangeSlider.skinHTML5.css"/>

  </head>
  <body>

    <div class='container'>
        <h3 class='text-primary' id = 'page-title'>Local Citation Network Explorer</h3>

        <div id='input-control'>
            <input id='titleInput' type="text" onkeydown = "if (event.keyCode == 13)
                        document.getElementById('titleSearchButton').click()"></input>

            <button class = 'btn btn-default' id="titleSearchButton" type="button" onclick="microsoft.titleSearch(titleQuery)">Search for Seeds by Title</button>
            <input id='doiInput' type="text" onkeydown = "if (event.keyCode == 13)
                        document.getElementById('searchButton').click()"></input>

            <button class = 'btn btn-default' id="searchButton" type="button" onclick='addSeedFromDOI(doiQuery)'>Add Seeds by DOI</button>
            <div><strong>Add Seeds by BibTex: </strong><input type="file" id="files" name="files[]" multiple />
            <output id="list"></output></div>
        </div>


<ul class="nav nav-tabs">
    <li><a href="#a" data-toggle="tab">Search Results</a></li>        
   <li><a href="#b" data-toggle="tab">My Seed Papers</a></li>
   <li><a href="#c" data-toggle="tab">Connected Papers</a></li>
   <li><a href="#d" data-toggle="tab">Network Viewer</a></li>
</ul>

<div class="tab-content">
    <div class="tab-pane" id="a">
            <table id="searchTable" class="table">
                    <thead>
                        <th>Title</th>
                        <th>Year</th>
                        <th>DOI</th>
                        <th></th>
                    </thead>
                    <tbody>
                        <tr></tr>
                    </tbody>
            </table>
    </div>
   <div class="tab-pane active" id="b">
       <table id="seedTable" class="table">
            <thead>
                <th>Title</th>
                <th>Author</th>
                <th>Year</th>
                <th>DOI</th>
                <th></th>
            </thead>
            <tbody>
            </tbody>
        </table>
   </div>
   <div class="tab-pane" id="c">
        <table id="resultsTable" class="table">
            <thead>
                <th>Title</th>
                <th>Author</th>
                <th>Year</th>
                <th>DOI</th>
                <th>Seeds Cited</th>
                <th>Seeds Cited-By</th>
                <th></th>
            </thead>
            <tbody>
            </tbody>
        </table>
   </div>

   <div class="tab-pane" id="d">

        <div id="network" class='row'>
            <div class="col-md-9">
                <svg id="forceGraph" width="800" height="600"></svg>
            </div>
                <div id ="detailBox" class="panel panel-default col-md-3">
                    <div class="panel-body">
                        <p id='info-title'></p>
                        <p id='info-doi'></p>
                        <p id='info-author'></p>
                        <p id='info-year'></p>
                        <p id='info-abstract'></p>
                        <div id='addSeed'><button class = 'btn btn-default' type="button" onclick='addSeedFromRecord(selectednode.ID)'>Add Seed</button></div>                
                    </div>
                </div>  
            <div id="controlPanel" class="panel panel-default col-md-3">
                <div class="panel-heading"><h4>Control Panel</h4>
                </div>
                <div class="panel-body">
                    <div><b>Threshold Slider:</b></div>
                    <input type="text" id="slider" name="example_name" value="" />
                    <div>
                    <button onclick ='mode = "citedBy";updateGraph(Papers,Edges)'>Cited-By</button>
                    <button onclick ='mode = "ref";updateGraph(Papers,Edges)'>References</button>
                    </div>
                </div>
            </div>
            

        </div>

   </div>


</div>
    <script src = "apikeys.js"></script>
    <script src = "core.js"></script>
    <script src = "crossref-master/crossref.min.js"></script>
    <script src = "crossref.js"></script>
    <script src = "occ.js"></script>
    <script src = "microsoft.js"></script>
    <script src = "plotNetwork.js"></script>
    <script src = "bibtexParse.js"></script>

     <script>


    $("#slider").ionRangeSlider({

        min:1,
        max:10,
        from: minconnections,
        onFinish: function(data){
            
            minconnections = data.from;
            threshold(minconnections);}

    });


    
     $(document).ready(function() {


        $('#searchTable').DataTable({
                data: [],
                columns: [
                { "data": "OriginalTitle" },
                { "data": "PublishYear" },
                { "data": "DOI","render": function(data,type,row){return "<a href='https://doi.org/"+data+"'>"+data+"</a>"}},
                { "data": "CellID","render": function(data,type,row){
                    
                    return "<div id='add"+data+"'><button  class='btn btn-info btn-sm' onclick = addSeedFromSearchTable('"+data+"','"+row.DOI+"')>Add</button></div>"
                    
                    }
                
                }

            ]});


        $('#seedTable').DataTable( {
                data: [],
                columns: [
                    { "data": "Title" },
                    { "data": "Author"},
                    { "data": "Year" },
                    { "data": "DOI","render": function(data,type,row){return "<a href='https://doi.org/"+data+"'>"+data+"</a>"}},
                    { "data": "ID","render": function(data,type,row){return "<button class='btn btn-danger btn-sm' onclick = deleteSeed('"+data+"')>Delete</button>"}}

                ]
    } );
    
        $('#resultsTable').DataTable( {
                data: [],
                columns: [
                    { "data": "Title" },
                    { "data": "Author"},
                    { "data": "Year" },
                    { "data": "DOI","render": function(data,type,row){return "<a href='https://doi.org/"+data+"'>"+data+"</a>"}},
                    { "data": "seedsCited"},
                    { "data": "seedsCitedBy"},
                    { "data": "ID","render": function(data,type,row){
                        
                        if(row.seed){return "<button class='btn btn-success btn-sm'><span class='glyphicon glyphicon-ok'></span></button>"}else{
                            return "<div id='add"+data+"'><button  class='btn btn-info btn-sm' onclick = addSeedFromRecord('"+data+"')>Add</button></div>"}
                        }      
                    }
                ]
        } );

     });


    </script>

  </body>
</html>

